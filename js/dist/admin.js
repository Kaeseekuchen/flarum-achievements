module.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=28)}([function(e,t){e.exports=flarum.core.compat.Model},function(e,t){e.exports=flarum.core.compat["utils/Stream"]},function(e,t,a){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)}a.d(t,"a",(function(){return i}))},function(e,t,a){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}a.d(t,"a",(function(){return n}))},function(e,t){e.exports=flarum.core.compat["components/Button"]},function(e,t){e.exports=flarum.core.compat["models/User"]},function(e,t){e.exports=flarum.core.compat["helpers/icon"]},function(e,t){e.exports=flarum.core.compat["components/Modal"]},function(e,t){e.exports=flarum.core.compat["utils/ItemList"]},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(3),i=a(2),o=a(0),s=a.n(o),m=(a(13),function(e){function t(){return e.apply(this,arguments)||this}return Object(i.a)(t,e),t}(s.a));Object(n.a)(m.prototype,{id:s.a.attribute("id"),name:s.a.attribute("name"),description:s.a.attribute("description"),computation:s.a.attribute("computation"),points:s.a.attribute("points"),rectangle:s.a.attribute("rectangle"),image:s.a.attribute("image"),new:s.a.attribute("new"),active:s.a.attribute("active")})},function(e,t){e.exports=flarum.core.compat["components/LoadingIndicator"]},function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return h}));var n=a(0),i=a.n(n),o=a(5),s=a.n(o),m=a(9),r=a(3),l=a(2),c=function(e){function t(){return e.apply(this,arguments)||this}return Object(l.a)(t,e),t}(i.a);function h(){s.a.prototype.achievements=i.a.hasMany("achievements","achievement_user"),s.a.prototype.achievement_user=i.a.hasMany("achievement_user"),app.store.models.achievements=m.a,app.store.models.achievement_user=c}Object(r.a)(c.prototype,{achievement_id:i.a.attribute("achievement_id"),user_id:i.a.attribute("user_id"),new:i.a.attribute("new")})},,function(e,t){e.exports=flarum.core.compat["utils/mixin"]},,,,,function(e,t){e.exports=flarum.core.compat["components/ExtensionPage"]},function(e,t){e.exports=flarum.core.compat["components/Checkbox"]},function(e,t){e.exports=flarum.core.compat.Component},function(e,t){e.exports=flarum.core.compat["components/Dropdown"]},,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(11),i=a(2),o=a(18),s=a.n(o),r=a(10),l=a.n(r),c=a(6),h=a.n(c),d=a(7),u=a.n(d),p=a(4),v=a.n(p),g=a(19),f=a.n(g),b=a(8),_=a.n(b),y=a(1),N=a.n(y),w=a(20),x=a.n(w),F=a(21),I=a.n(F),A=function(e){function t(){return e.apply(this,arguments)||this}return Object(i.a)(t,e),t.prototype.view=function(){var e=this,t=app.translator.trans("malago-achievements.admin.achievement_modal.variable."+this.attrs.id());return m("span",null,m(I.a,{label:t,buttonClassName:"Button Button--danger"},["manual","posts","likes","selflikes","discussions","edits","avatar","comments","contains","meanwords","tagposts","years"].map((function(t){return v.a.component({active:e.attrs.id(),onclick:function(){e.attrs.id(t),"avatar"==t||"manual"==t?$(".FormInline").addClass("FormHidden"):$(".FormInline").removeClass("FormHidden")}},app.translator.trans("malago-achievements.admin.achievement_modal.variable."+t))}))))},t}(x.a),O=function(e){function t(){return e.apply(this,arguments)||this}Object(i.a)(t,e);var a=t.prototype;return a.oninit=function(t){if(e.prototype.oninit.call(this,t),this.achievement=this.attrs.model||app.store.createRecord("achievements"),this.id=N()(this.achievement.data.id||"-"),this.name=N()(this.achievement.name()||""),this.description=N()(this.achievement.description()||""),this.achievement.computation()){var a=this.achievement.computation().split(":");this.selected_variable=N()(a[0]),this.computation=N()(a[1]),"avatar"!=this.selected_variable()&&"manual"!=this.selected_variable()||$(".FormInline").hide()}else this.computation=N()(""),this.selected_variable=N()("manual");if(this.points=N()(this.achievement.points()||""),this.image=N()(this.achievement.image()||""),this.active=N()(this.achievement.active()||""),this.achievement.rectangle()){var n=this.achievement.rectangle().split(",");this.row=N()(n[0]/n[2]+1),this.col=N()(n[1]/n[3]+1),this.width=N()(n[3]),this.height=N()(n[2])}else this.row=N()("1"),this.col=N()("1"),this.width=N()(""),this.height=N()("")},a.className=function(){return"EditAchievementModal Modal--small"},a.title=function(){return this.name()?this.name()+" ID: "+this.id():app.translator.trans("malago-achievements.admin.achievement_modal.title")},a.content=function(){return this.loading?m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"container"},m(l.a,null)))):m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fields().toArray()))},a.fields=function(){var e=this,t=new _.a;return t.add("name",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.name_label")),m("input",{className:"FormControl",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.name_placeholder"),bidi:this.name})),50),t.add("active",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.active_label")),f.a.component({state:this.active(),onchange:function(){e.active((e.active()+1)%2)}})),50),t.add("description",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.description_label")),m("input",{className:"FormControl",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.description_placeholder"),bidi:this.description})),50),t.add("computation",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.variable_label")),m(A,{label:app.translator.trans("malago-achievements.admin.achievement_modal.variable_label"),id:this.selected_variable}),m("input",{className:"avatar"==this.selected_variable()||"manual"==this.selected_variable()?"FormControl FormHidden FormInline":"FormControl FormInline",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.computation_placeholder"),bidi:this.computation})),50),t.add("points",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.points_label")),m("input",{className:"FormControl",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.points_placeholder"),bidi:this.points})),50),t.add("image",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.image_label")),m("input",{className:"FormControl",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.image_placeholder"),bidi:this.image,onchange:this.showImage()})),50),t.add("image-show",m("div",{className:"Form-group"},m("div",{class:"AchievementImage-Show"},"Â ")),50),t.add("size",m("div",{className:"Form-group Image-data"},m("table",{className:"AchievementModal-Table"},m("tr",null,m("td",null,m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.height_label"))),m("td",null,m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.width_label")))),m("tr",null,m("td",null,m("input",{className:"FormControl",bidi:this.height,onchange:this.showImage(),type:"number"})),m("td",null,m("input",{className:"FormControl",bidi:this.width,onchange:this.showImage(),type:"number"}))))),50),t.add("position",m("div",{className:"Form-group Image-data"},m("table",{className:"AchievementModal-Table"},m("tr",null,m("td",null,m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.row_label"))),m("td",null,m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.col_label")))),m("tr",null,m("td",null,m("input",{className:"FormControl",placeholder:1,bidi:this.col,onchange:this.showImage(),type:"number"})),m("td",null,m("input",{className:"FormControl",placeholder:1,bidi:this.row,onchange:this.showImage(),type:"number"}))))),50),t.add("submit",m("div",{className:"Form-group"},v.a.component({type:"submit",className:"Button Button--primary EditAchievementModal-save",loading:this.loading,disabled:0===this.name().length},app.translator.trans("malago-achievements.admin.achievement_modal.submit_button")),this.achievement.exists?m("button",{type:"button",className:"Button EditAchievementsModal-delete",onclick:this.delete.bind(this)},app.translator.trans("malago-achievements.admin.achievement_modal.delete_button")):""),-10),t},a.showImage=function(){this.image().includes("http")?($(".AchievementImage-Show").html(""),$(".Image-data").show(),$(".AchievementImage-Show").css("background-position","-"+(this.row()-1)*this.height()+"px -"+(this.col()-1)*this.width()+"px"),$(".AchievementImage-Show").css("background-image","url("+this.image()+")"),$(".AchievementImage-Show").css("width",this.width()+"px"),$(".AchievementImage-Show").css("height",this.height()+"px")):($(".AchievementImage-Show").html("<i class='icon "+this.image()+"'></i>"),$(".AchievementImage-Show").css("background","none"),$(".AchievementImage-Show").css("height","32px"),$(".AchievementImage-Show").css("width","32px"),$(".Image-data").hide())},a.submitData=function(){return{name:this.name(),description:this.description(),computation:this.selected_variable()+":"+this.computation(),points:this.points(),image:this.image(),rectangle:[(this.row()-1)*this.height(),(this.col()-1)*this.width(),this.height(),this.width()].join(","),active:this.active()}},a.onsubmit=function(e){var t=this;e.preventDefault(),this.loading=!0,this.achievement.save(this.submitData()).then((function(){return t.hide()}),(function(){return t.loading=!1}))},a.delete=function(){confirm(app.translator.trans("malago-achievements.admin.achievement_modal.delete_confirmation"))&&(this.achievement.delete().then((function(){m.redraw()})),this.hide())},t}(u.a),j=function(e){function t(){return e.apply(this,arguments)||this}Object(i.a)(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.achievement=this.attrs.model,this.achievement_user=app.store.createRecord("achievement_user"),this.name=N()(this.achievement.name()||""),this.id=N()(this.achievement.data.id||""),this.user_id=N()("")},a.className=function(){return"EditAchievementModal Modal--small"},a.title=function(){return this.name()?this.name():app.translator.trans("malago-achievements.admin.achievement_modal.add_delete_title")},a.content=function(){return this.loading?m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"container"},m(l.a,null)))):m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fields().toArray()))},a.fields=function(){var e=new _.a;return e.add("instructions",m("div",{className:"Form-group"},m("p",null,app.translator.trans("malago-achievements.admin.achievement_modal.add_delete_instructions"))),50),e.add("user_id",m("div",{className:"Form-group"},m("label",null,app.translator.trans("malago-achievements.admin.achievement_modal.username")),m("input",{className:"FormControl",placeholder:app.translator.trans("malago-achievements.admin.achievement_modal.username_placeholder"),bidi:this.user_id})),50),e.add("submit",m("div",{className:"Form-group"},v.a.component({type:"submit",className:"Button Button--primary EditAchievementModal-save",loading:this.loading,disabled:0===this.name().length},app.translator.trans("malago-achievements.admin.achievement_modal.submit_button"))),-10),e},a.submitData=function(){return{id:this.id(),user_id:this.user_id(),new:1}},a.onsubmit=function(e){var t=this;e.preventDefault(),this.loading=!0,""!=this.user_id()&&this.achievement_user.save(this.submitData()).then((function(){return t.hide()}),(function(){return t.loading=!1}))},t}(u.a);function M(e){var t=e?e.name():app.translator.trans("malago-achievements.admin.achievements_page.create_achievement_button"),a=(e?e.rectangle():"0,0,32,32").split(","),n=e?"":h()("fas fa-plus"),i=app.translator.trans("malago-achievements.admin.achievements_page.add_delete_users"),o="background:none;      height:32px;      width:32px;";return e&&(e.image().includes("http")?o="background:url("+e.image()+");      background-position:-"+a[0]+"px -"+a[1]+"px;      height:"+a[2]+"px;      width:"+a[3]+"px;":n=h()(e.image())),m("div",{className:"ExtensionListItem"},m("span",{className:"ExtensionListItem-icon ExtensionIcon Achievement",style:o,onclick:function(){return app.modal.show(O,{model:e})}},n),m("span",{className:"ExtensionListItem-title"},t),m("span",{className:"ExtensionListItem-user","data-toggle":"tooltip",title:i,onclick:function(){return e?app.modal.show(j,{model:e}):null}},m("i",{class:"fas fa-users-cog"})))}var C=function(e){function t(){return e.apply(this,arguments)||this}Object(i.a)(t,e);var a=t.prototype;return a.oninit=function(t){var a=this;e.prototype.oninit.call(this,t),this.loading=!0,app.store.find("achievements").then((function(){a.loading=!1,m.redraw()}))},a.content=function(){return this.loading?m("div",{className:"Achievements"},m("div",{className:"container"},m(l.a,null))):m("div",{className:"Achievements"},m("div",{className:"container"},m("div",{className:"ExtensionsWidget-list Achievements-list"},m("p",{className:"Achievements-list-heading"},app.translator.trans("malago-achievements.admin.achievements_page.list_heading")),m("div",{className:"ExtensionList"},[].concat(app.store.all("achievements").map(M),[M()]))),m("div",{className:"Achievements-footer"},m("p",null,app.translator.trans("malago-achievements.admin.achievements_page.instructions_header")),m("ul",null,app.translator.trans("malago-achievements.admin.achievements_page.instructions_text")))))},t}(s.a);app.initializers.add("malago/achievements",(function(){app.extensionData.for("malago-achievements").registerPage(C),Object(n.default)()}))}]);
//# sourceMappingURL=admin.js.map